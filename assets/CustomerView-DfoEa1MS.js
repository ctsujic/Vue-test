import{j as N,r as p,a,h as s,b as e,i as I,w as m,v,g as y,_ as U,o as x,d as O,t as c,F as b,f as S,e as F,q as T}from"./index-tvMXVzfh.js";const $={class:"card"},g={class:"card-body"},w={class:"row"},V={class:"col-md-6 mb-3"},M={class:"col-md-6 mb-3"},E={class:"col-md-6 mb-3"},A={class:"col-md-6 mb-3"},q=Object.assign({name:"CustomerForm"},{__name:"CustomerForm",setup(h){const d=N(),l=p({C_NAME:"",C_DISCOUNT:0,C_CashFee:0,C_TransactionFee:0}),o=async()=>{try{await y.post("/customers",l.value),alert("客戶新增成功"),l.value={C_NAME:"",C_DISCOUNT:0,C_CashFee:0,C_TransactionFee:0},d.push("/customer")}catch(i){console.error("新增客戶失敗：",i),alert("新增客戶失敗")}};return(i,t)=>(s(),a("div",$,[e("div",g,[t[9]||(t[9]=e("h3",{class:"card-title mb-4"},"新增客戶",-1)),e("form",{onSubmit:I(o,["prevent"])},[e("div",w,[e("div",V,[t[4]||(t[4]=e("label",{for:"C_NAME",class:"form-label"},"客戶名稱",-1)),m(e("input",{type:"text",class:"form-control",id:"C_NAME","onUpdate:modelValue":t[0]||(t[0]=C=>l.value.C_NAME=C),required:""},null,512),[[v,l.value.C_NAME]])]),e("div",M,[t[5]||(t[5]=e("label",{for:"C_DISCOUNT",class:"form-label"},"預設折扣 (%)",-1)),m(e("input",{type:"number",class:"form-control",id:"C_DISCOUNT","onUpdate:modelValue":t[1]||(t[1]=C=>l.value.C_DISCOUNT=C),min:"0",max:"100",step:"0.01",required:""},null,512),[[v,l.value.C_DISCOUNT]])]),e("div",E,[t[6]||(t[6]=e("label",{for:"C_CashFee",class:"form-label"},"金流費 (%)",-1)),m(e("input",{type:"number",class:"form-control",id:"C_CashFee","onUpdate:modelValue":t[2]||(t[2]=C=>l.value.C_CashFee=C),min:"0",max:"100",step:"0.001",required:""},null,512),[[v,l.value.C_CashFee]])]),e("div",A,[t[7]||(t[7]=e("label",{for:"C_TransactionFee",class:"form-label"},"成交費 (%)",-1)),m(e("input",{type:"number",class:"form-control",id:"C_TransactionFee","onUpdate:modelValue":t[3]||(t[3]=C=>l.value.C_TransactionFee=C),min:"0",max:"100",step:"0.001",required:""},null,512),[[v,l.value.C_TransactionFee]])])]),t[8]||(t[8]=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-primary"},"儲存")],-1))],32)])]))}}),B={class:"card"},j={class:"card-body"},L={key:0,class:"alert alert-danger",role:"alert"},R={class:"table-responsive"},Y={class:"table table-hover"},z={key:0},G=["onClick"],H=["onClick"],J=["onClick"],K=Object.assign({name:"CustomerList"},{__name:"CustomerList",setup(h){const d=p([]),l=p(null),o=p(null),i=p({C_DISCOUNT:0,C_CashFee:0,C_TransactionFee:0}),t=u=>{o.value=u.C_ID,i.value={C_DISCOUNT:u.C_DISCOUNT,C_CashFee:u.C_CashFee,C_TransactionFee:u.C_TransactionFee}},C=async u=>{try{await y.patch(`/customers/${u}`,i.value),alert("更新成功"),o.value=null,f()}catch(r){console.error("更新客戶失敗：",r),alert("更新失敗")}},D=()=>{o.value=null,i.value={C_DISCOUNT:0,C_CashFee:0,C_TransactionFee:0}},f=async()=>{try{const{data:u}=await y.get("/customers");d.value=u}catch(u){console.error("獲取客戶列表失敗：",u),l.value="獲取客戶資料失敗"}},k=async u=>{if(confirm("確定要刪除此客戶嗎？"))try{await y.delete(`/customers/${u}`),alert("刪除成功"),f()}catch(r){console.error("刪除客戶失敗：",r),alert("刪除失敗")}};return x(()=>{f()}),(u,r)=>(s(),a("div",B,[e("div",j,[l.value?(s(),a("div",L,c(l.value),1)):O("",!0),e("div",R,[e("table",Y,[r[4]||(r[4]=e("thead",null,[e("tr",null,[e("th",null,"編號"),e("th",null,"帳號"),e("th",null,"下單次數"),e("th",null,"總金額"),e("th",null,"預設折扣"),e("th",null,"金流費"),e("th",null,"成交費"),e("th",null,"操作")])],-1)),e("tbody",null,[d.value.length===0?(s(),a("tr",z,r[3]||(r[3]=[e("td",{colspan:"8",class:"text-center"},"暫無資料",-1)]))):(s(!0),a(b,{key:1},S(d.value,n=>(s(),a("tr",{key:n.id},[e("td",null,c(n.C_ID),1),e("td",null,c(n.C_NAME),1),e("td",null,c(n.C_NB),1),e("td",null,c(n.C_MONEY),1),e("td",null,[o.value===n.C_ID?m((s(),a("input",{key:0,type:"number",class:"form-control form-control-sm","onUpdate:modelValue":r[0]||(r[0]=_=>i.value.C_DISCOUNT=_),min:"0",max:"100",step:"0.01"},null,512)),[[v,i.value.C_DISCOUNT]]):(s(),a(b,{key:1},[F(c(n.C_DISCOUNT),1)],64))]),e("td",null,[o.value===n.C_ID?m((s(),a("input",{key:0,type:"number",class:"form-control form-control-sm","onUpdate:modelValue":r[1]||(r[1]=_=>i.value.C_CashFee=_),min:"0",max:"100",step:"0.001"},null,512)),[[v,i.value.C_CashFee]]):(s(),a(b,{key:1},[F(c(n.C_CashFee),1)],64))]),e("td",null,[o.value===n.C_ID?m((s(),a("input",{key:0,type:"number",class:"form-control form-control-sm","onUpdate:modelValue":r[2]||(r[2]=_=>i.value.C_TransactionFee=_),min:"0",max:"100",step:"0.001"},null,512)),[[v,i.value.C_TransactionFee]]):(s(),a(b,{key:1},[F(c(n.C_TransactionFee),1)],64))]),e("td",null,[o.value===n.C_ID?(s(),a(b,{key:0},[e("button",{class:"btn btn-sm btn-success me-2",onClick:_=>C(n.C_ID)}," 完成 ",8,G),e("button",{class:"btn btn-sm btn-secondary me-2",onClick:D},"取消")],64)):(s(),a(b,{key:1},[e("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:_=>t(n)}," 編輯 ",8,H),e("button",{class:"btn btn-sm btn-outline-danger",onClick:_=>k(n.C_ID)}," 刪除 ",8,J)],64))])]))),128))])])])])]))}}),P=U(K,[["__scopeId","data-v-2c65f241"]]),Q={class:"row mb-4"},W={class:"col text-end"},Z=Object.assign({name:"CustomerView"},{__name:"CustomerView",setup(h){const d=p(!1);return(l,o)=>(s(),a("div",null,[e("div",Q,[o[1]||(o[1]=e("div",{class:"col"},[e("h2",null,"客戶管理")],-1)),e("div",W,[e("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=i=>d.value=!d.value)},c(d.value?"返回列表":"新增客戶"),1)])]),d.value?(s(),T(q,{key:0})):(s(),T(P,{key:1}))]))}});export{Z as default};
